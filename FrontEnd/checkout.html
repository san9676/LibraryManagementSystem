<!DOCTYPE html>
<html>
<head>
	<title>Book CheckOut</title>
	<style>
	table {
		border-collapse: collapse;
		width: 100%;
	}

	th, td {
		text-align: left;
		padding: 8px;
		border-bottom: 1px solid #ddd;
		border-right: 1px solid #ddd; /* Add border between columns */
	}

	th {
		background-color: #4CAF50;
		color: white;
	}
</style>
	<script>
		function checkout() {
					var Data = {
									  "library_card_number": document.getElementById("cardno").value,
									  "book_id":document.getElementById("bookid").value,
									  "Renew": {
										"transactionID": document.getElementById("tranID").value,
										"isRenew": document.getElementById("renew").value
									   
									  }
									};
			
			var xhr = new XMLHttpRequest();
		xhr.onreadystatechange = function() {
			if (xhr.readyState === XMLHttpRequest.DONE) {
			
				var response = JSON.parse(this.responseText);
				if (xhr.status === 200) {
				var data = response.BookCheckOutRes;
				var table = document.getElementById("userTable");
				var row = table.insertRow(-1);
				var TranIDCell = row.insertCell(0);
				var bookidCell = row.insertCell(1);
				var duedateCell = row.insertCell(2);
				var statusCell = row.insertCell(3);
				TranIDCell.innerHTML = data.transaction_id;
				bookidCell.innerHTML = data.book_id;
				duedateCell.innerHTML = data.due_date;
				statusCell.innerHTML = data.status;
			}
			else {
				alert("failed: " + response.fault.FaultCode + ":" + response.fault.FaultMsg);
			}
			};
			}
		
			xhr.open("POST", "http://localhost:9702/api/v1/circulation/checkout", true);
			//xhr.setRequestHeader('Content-Type', 'application/json');
			
			xhr.send(JSON.stringify(Data));
		}
	</script>
</head>
<body>
	<h2>Book CheckOut</h2>
	<button onclick="window.location.href='circulation.html';">
      Back
    </button>
	<button onclick="window.location.href='HomePage.html';">
      Home
    </button><br>
	<form>
		<label for="cardno">Library Card Number:</label><br>
		<input type="text" id="cardno" name="cardno"><br>
		<label for="bookid">Book ID:</label><br>
		<input type="text" id="bookid" name="bookid"><br>
		<label>Renew</label>
		<select id="renew" name="Renew">
			<option  value="false"></option>
			<option  value="true">Yes</option>
			<option  value="false">No</option>
		</select><br>
		
		<div id="isrenew" style="display: none;">
			<label for="tranID">Tranasaction ID:</label><br>
			<input type="text" id="tranID" name="tranID"><br>
		</div>
		<br><br>
		<input type="button" value="Submit" onclick="checkout()">
	</form>
	<br><br>
	<table id="userTable">
		<thead>
			<tr>
				<th>Transaction ID</th>
				<th>Book ID</th>
				<th>Due Date</th>
				<th>Status</th>
			</tr>
		</thead>
		<tbody>
		</tbody>
	</table>
	<script>
      document.getElementById('renew').addEventListener('change', function() {
        if (this.value === 'true') {
          document.getElementById('isrenew').style.display = 'block';
        } else {
          document.getElementById('isrenew').style.display = 'none';
        }
      });
    </script>
</body>
</html>
