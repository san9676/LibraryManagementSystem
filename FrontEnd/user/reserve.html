<!DOCTYPE html>
<html>
<head>
	<title>Reserve Book</title>
	<style>
	table {
		border-collapse: collapse;
		width: 100%;
	}

	th, td {
		text-align: left;
		padding: 8px;
		border-bottom: 1px solid #ddd;
		border-right: 1px solid #ddd; /* Add border between columns */
	}

	th {
		background-color: #4CAF50;
		color: white;
	}
</style>
	<script>
		function reserveBook() {
			var cardNo = document.getElementById("cardNo").value;
			var book_id = document.getElementById("book_id").value;
			var reservation_date = document.getElementById("reservation_date").value;

			var xhr = new XMLHttpRequest();
			var url = "http://localhost:9703/api/v1/reservation/reserve";
			xhr.open("POST", url, true);
			//xhr.setRequestHeader("Content-Type", "application/json");

			xhr.onreadystatechange = function() {
			   if (xhr.readyState === XMLHttpRequest.DONE) {
			
				var response = JSON.parse(this.responseText);
				if (xhr.status === 200) {
				var data = response.reserveBookRes;
				var table = document.getElementById("userTable");
				var row = table.insertRow(-1);
				var reserIDCell = row.insertCell(0);
				var cardCell = row.insertCell(1);
				var bookidCell = row.insertCell(2);
				var reserDateCell = row.insertCell(3);
				var statusCell = row.insertCell(4);
				var emailCell = row.insertCell(5);
				
				reserIDCell.innerHTML = data.reservation_id;
				cardCell.innerHTML = data.cardNo;
				bookidCell.innerHTML = data.book_id;
				reserDateCell.innerHTML = data.reservation_date;
				statusCell.innerHTML = data.status;
				emailCell.innerHTML = data.email;
			}
			else {
				alert("failed: " + response.fault.FaultCode + ":" + response.fault.FaultMsg);
			}
			};
			}

			var data = JSON.stringify({"cardNo": cardNo, "book_id": book_id, "reservation_date": reservation_date});
			xhr.send(data);
		}
	</script>
</head>
<body>
	<h1>Reserve Book</h1>
	<button onclick="window.location.href='reservation.html';">
      Back
    </button>
	<button onclick="window.location.href='userHomePage.html';">
      Home
    </button><br><br>
	<form>
		<label for="cardNo">Card Number:</label><br>
		<input type="text" id="cardNo" name="cardNo" ><br>

		<label for="book_id">Book ID:</label><br>
		<input type="text" id="book_id" name="book_id" ><br>

		<label for="reservation_date">Reservation Date:</label><br>
		<input type="date" id="reservation_date" name="reservation_date" ><br>
		<br>

		<button type="button" onclick="reserveBook()">Reserve</button>
	</form>
	<br><br>
	<table id="userTable">
		<thead>
			<tr>
				<th>Reservation ID</th>
				<th>Card No</th>
				<th>Book ID</th>
				<th>Reservation Date</th>
				<th>Status</th>
				<th>Email</th>
			</tr>
		</thead>
		<tbody>
		</tbody>
	</table>
</body>
</html>
